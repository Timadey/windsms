import{c as Pe,r as je,u as ye,j as s,H as Ue,b as Fe}from"./app-Coi7k2fI.js";import{B as U}from"./button-mceLiHuI.js";import{I as be}from"./input-D6ZICJAD.js";import{L as F}from"./label-Cdcyeb-A.js";import{D as ve,a as Ne,b as De,c as we,d as ke}from"./dialog-6Qxs2ILL.js";import{T as He,a as Ce,b as H,e as I,c as Ie,d as Le}from"./table-BC3ZnHDA.js";import{B as _e}from"./badge-D2YSTo2C.js";import{k as Ee,l as Oe,A as Re,m as Ve}from"./app-layout-CXlp6xIM.js";import{d as ze}from"./index-r6wekaLU.js";import{P as We}from"./pagination-BKou5r5W.js";import{U as $e}from"./upload-BlteuxDm.js";import{P as qe}from"./plus-Dd7uTSXA.js";/* empty css            */import"./utils-DFaayVYX.js";import"./index-CnJWrOY4.js";import"./x-Cs-N5IsK.js";import"./index-pZIn0PeW.js";import"./megaphone-DgyCe930.js";import"./users-C0mFNV0M.js";function js(n){const e=Pe.c(97),{subscribers:o,tags:c}=n,[ae,ge]=je.useState(!1),[ne,Se]=je.useState(!1);let L;e[0]!==o.links?(L=o.links||[],e[0]=o.links,e[1]=L):L=e[1];const re=L,[oe,Te]=je.useState("");let E;e[2]===Symbol.for("react.memo_cache_sentinel")?(E={phone_number:"",name:"",tag_ids:[]},e[2]=E):E=e[2];const{data:a,setData:r,post:ce,processing:de,reset:me,errors:d}=ye(E);let O;e[3]===Symbol.for("react.memo_cache_sentinel")?(O={file:null,tag_ids:[]},e[3]=O):O=e[3];const i=ye(O);let R;e[4]!==r?(R=t=>{t.preventDefault();const l=t.target.value,P=l.split(",").map(Xe).filter(Qe);r("phone_number",P),Te(l)},e[4]=r,e[5]=R):R=e[5];const he=R;let m;e[6]!==d?(m=Object.keys(d).filter(Me),e[6]=d,e[7]=m):m=e[7];let V;e[8]!==d||e[9]!==m?(V=m.map(t=>d[t]),e[8]=d,e[9]=m,e[10]=V):V=e[10];const fe=V.join(" ");let z;e[11]!==a.phone_number.length||e[12]!==ce||e[13]!==me?(z=t=>{if(t.preventDefault(),a.phone_number.length<1){alert("Please enter at least one phone number.");return}ce(Ee().url,{onSuccess:()=>{me(),ge(!1)}})},e[11]=a.phone_number.length,e[12]=ce,e[13]=me,e[14]=z):z=e[14];const pe=z;let W;e[15]!==i?(W=t=>{t.preventDefault(),i.post(Oe().url,{onSuccess:()=>{i.reset(),Se(!1)}})},e[15]=i,e[16]=W):W=e[16];const ue=W,Ae=Je;let $;e[17]===Symbol.for("react.memo_cache_sentinel")?($=[{title:"Dashboard",href:ze().url}],e[17]=$):$=e[17];const Be=$;let q;e[18]===Symbol.for("react.memo_cache_sentinel")?(q=s.jsx(Ue,{title:"Subscribers"}),e[18]=q):q=e[18];let G;e[19]===Symbol.for("react.memo_cache_sentinel")?(G=s.jsx("h2",{className:"text-2xl font-semibold",children:"Subscribers"}),e[19]=G):G=e[19];let J;e[20]===Symbol.for("react.memo_cache_sentinel")?(J=s.jsx(ve,{asChild:!0,children:s.jsxs(U,{variant:"outline",children:[s.jsx($e,{className:"mr-2 h-4 w-4"}),"Bulk Upload"]})}),e[20]=J):J=e[20];let K;e[21]===Symbol.for("react.memo_cache_sentinel")?(K=s.jsx(Ne,{children:s.jsx(De,{children:"Bulk Upload Subscribers"})}),e[21]=K):K=e[21];let M;e[22]===Symbol.for("react.memo_cache_sentinel")?(M=s.jsx(F,{htmlFor:"file",children:"CSV File"}),e[22]=M):M=e[22];let h;e[23]!==i?(h=s.jsx(be,{id:"file",type:"file",accept:".csv,.txt",onChange:t=>i.setData("file",t.target.files[0])}),e[23]=i,e[24]=h):h=e[24];let Q;e[25]===Symbol.for("react.memo_cache_sentinel")?(Q=s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"CSV should have columns: phone_number, name (optional)"}),e[25]=Q):Q=e[25];let f;e[26]!==h?(f=s.jsxs("div",{children:[M,h,Q]}),e[26]=h,e[27]=f):f=e[27];let X;e[28]===Symbol.for("react.memo_cache_sentinel")?(X=s.jsx(F,{children:"Tags (optional)"}),e[28]=X):X=e[28];let p;if(e[29]!==i||e[30]!==c){let t;e[32]!==i?(t=l=>s.jsx(_e,{variant:i.data.tag_ids.includes(l.id)?"default":"outline",className:"cursor-pointer",onClick:()=>{const P=i.data.tag_ids.includes(l.id)?i.data.tag_ids.filter(xe=>xe!==l.id):[...i.data.tag_ids,l.id];i.setData("tag_ids",P)},children:l.name},l.id),e[32]=i,e[33]=t):t=e[33],p=c.map(t),e[29]=i,e[30]=c,e[31]=p}else p=e[31];let u;e[34]!==p?(u=s.jsxs("div",{children:[X,s.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:p})]}),e[34]=p,e[35]=u):u=e[35];let x;e[36]!==i.processing?(x=s.jsx(U,{type:"submit",disabled:i.processing,children:"Upload"}),e[36]=i.processing,e[37]=x):x=e[37];let j;e[38]!==ue||e[39]!==f||e[40]!==u||e[41]!==x?(j=s.jsxs(we,{children:[K,s.jsxs("form",{onSubmit:ue,className:"space-y-4",children:[f,u,x]})]}),e[38]=ue,e[39]=f,e[40]=u,e[41]=x,e[42]=j):j=e[42];let b;e[43]!==ne||e[44]!==j?(b=s.jsxs(ke,{open:ne,onOpenChange:Se,children:[J,j]}),e[43]=ne,e[44]=j,e[45]=b):b=e[45];let Y;e[46]===Symbol.for("react.memo_cache_sentinel")?(Y=s.jsx(ve,{asChild:!0,children:s.jsxs(U,{children:[s.jsx(qe,{className:"mr-2 h-4 w-4"}),"Add Subscriber"]})}),e[46]=Y):Y=e[46];let Z;e[47]===Symbol.for("react.memo_cache_sentinel")?(Z=s.jsx(Ne,{children:s.jsx(De,{children:"Add New Subscriber"})}),e[47]=Z):Z=e[47];let ee;e[48]===Symbol.for("react.memo_cache_sentinel")?(ee=s.jsx(F,{htmlFor:"phone_number",children:"Phone Numbers (comma-separated)"}),e[48]=ee):ee=e[48];let _;e[49]!==he||e[50]!==oe||e[51]!==fe?(_=s.jsxs("div",{children:[ee,s.jsx(be,{id:"phone_number",value:oe,onChange:he,error:fe})]}),e[49]=he,e[50]=oe,e[51]=fe,e[52]=_):_=e[52];let se;e[53]===Symbol.for("react.memo_cache_sentinel")?(se=s.jsx(F,{htmlFor:"name",children:"Name (optional)"}),e[53]=se):se=e[53];let g;e[54]!==r?(g=t=>r("name",t.target.value),e[54]=r,e[55]=g):g=e[55];let S;e[56]!==a.name||e[57]!==g?(S=s.jsxs("div",{children:[se,s.jsx(be,{id:"name",value:a.name,onChange:g})]}),e[56]=a.name,e[57]=g,e[58]=S):S=e[58];let te;e[59]===Symbol.for("react.memo_cache_sentinel")?(te=s.jsx(F,{children:"Tags"}),e[59]=te):te=e[59];let y;if(e[60]!==a.tag_ids||e[61]!==r||e[62]!==c){let t;e[64]!==a.tag_ids||e[65]!==r?(t=l=>s.jsx(_e,{variant:a.tag_ids.includes(l.id)?"default":"outline",className:"cursor-pointer",onClick:()=>{const P=a.tag_ids.includes(l.id)?a.tag_ids.filter(xe=>xe!==l.id):[...a.tag_ids,l.id];r("tag_ids",P)},children:l.name},l.id),e[64]=a.tag_ids,e[65]=r,e[66]=t):t=e[66],y=c.map(t),e[60]=a.tag_ids,e[61]=r,e[62]=c,e[63]=y}else y=e[63];let v;e[67]!==y?(v=s.jsxs("div",{children:[te,s.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:y})]}),e[67]=y,e[68]=v):v=e[68];let N;e[69]!==de?(N=s.jsx(U,{type:"submit",disabled:de,children:"Add Subscriber"}),e[69]=de,e[70]=N):N=e[70];let D;e[71]!==pe||e[72]!==_||e[73]!==S||e[74]!==v||e[75]!==N?(D=s.jsxs(we,{children:[Z,s.jsxs("form",{onSubmit:pe,className:"space-y-4",children:[_,S,v,N]})]}),e[71]=pe,e[72]=_,e[73]=S,e[74]=v,e[75]=N,e[76]=D):D=e[76];let w;e[77]!==ae||e[78]!==D?(w=s.jsxs(ke,{open:ae,onOpenChange:ge,children:[Y,D]}),e[77]=ae,e[78]=D,e[79]=w):w=e[79];let k;e[80]!==b||e[81]!==w?(k=s.jsx("div",{className:"border-b p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[G,s.jsxs("div",{className:"flex gap-2",children:[b,w]})]})}),e[80]=b,e[81]=w,e[82]=k):k=e[82];let le;e[83]===Symbol.for("react.memo_cache_sentinel")?(le=s.jsx(He,{children:s.jsxs(Ce,{children:[s.jsx(H,{children:"Phone Number"}),s.jsx(H,{children:"Name"}),s.jsx(H,{children:"Tags"}),s.jsx(H,{children:"Added"}),s.jsx(H,{children:"Actions"})]})}),e[83]=le):le=e[83];let C;if(e[84]!==o.data){let t;e[86]===Symbol.for("react.memo_cache_sentinel")?(t=l=>s.jsxs(Ce,{children:[s.jsx(I,{className:"font-medium",children:l.phone_number}),s.jsx(I,{children:l.name||"-"}),s.jsx(I,{children:s.jsx("div",{className:"flex flex-wrap gap-1",children:l.tags?.map(Ge)})}),s.jsx(I,{children:new Date(l.created_at).toLocaleDateString()}),s.jsx(I,{children:s.jsx(U,{variant:"destructive",size:"sm",onClick:()=>Ae(l.id),children:"Delete"})})]},l.id),e[86]=t):t=e[86],C=o.data.map(t),e[84]=o.data,e[85]=C}else C=e[85];let T;e[87]!==C?(T=s.jsxs(Ie,{children:[le,s.jsx(Le,{children:C})]}),e[87]=C,e[88]=T):T=e[88];let A;e[89]!==re?(A=s.jsx(We,{links:re}),e[89]=re,e[90]=A):A=e[90];let B;e[91]!==T||e[92]!==A?(B=s.jsxs("div",{className:"p-6",children:[T,A]}),e[91]=T,e[92]=A,e[93]=B):B=e[93];let ie;return e[94]!==k||e[95]!==B?(ie=s.jsxs(Re,{breadcrumbs:Be,children:[q,s.jsx("div",{className:"py-12",children:s.jsx("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:s.jsxs("div",{className:"overflow-hidden bg-white shadow-sm sm:rounded-lg",children:[k,B]})})})]}),e[94]=k,e[95]=B,e[96]=ie):ie=e[96],ie}function Ge(n){return s.jsx(_e,{variant:"secondary",children:n.name},n.id)}function Je(n){confirm("Are you sure you want to delete this subscriber?")&&Fe.delete(Ve(n).url,{onSuccess:Ke,preserveScroll:!0})}function Ke(){}function Me(n){return n.startsWith("phone_number")}function Qe(n){return n!==""}function Xe(n){return n.trim()}export{js as default};
